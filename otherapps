#!/bin/bash
mkdir -p $MNT/results/tar
RESULTS_TAR=$MNT/results/tar
mkdir -p $MNT/results/untar
RESULTS_UNTAR=$MNT/results/untar
mkdir -p $MNT/results/grep
RESULTS_GREP=$MNT/results/grep
mkdir -p $MNT/results/gitclone
RESULTS_GITCLONE=$MNT/results/gitclone
cd $MNT
sudo sh -c "git clone https://github.com/torvalds/linux.git"
REPS=10
for i in $(seq 1 $REPS); do
	sudo sh -c "time -o $RESULTS_GITCLONE/gitclone_$i git clone https://github.com/foreverbell/xv6fs.git"
	sudo sh -c "time -o $RESULTS_GREP/grep_$i grep -r 'jbd2_journal_start' linux > grep"
	sudo sh -c "time -o $RESULTS_TAR/tar_$i tar -czf linux.tar.gz linux"
	sudo sh -c "time -o $RESULTS_UNTAR/untar_$i tar -xzf linux.tar.gz"
	sudo rm -rf linux.tar.gz xv6fs
done
